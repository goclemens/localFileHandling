(function(e,n){typeof exports==="object"&&typeof module!=="undefined"?module.exports=n():typeof define==="function"&&define.amd?define(n):e.localFileLoader=n()})(this,function(){"use strict";function e(e,n){console.log("start loading 'ascii' file - "+e);var t=new XMLHttpRequest;t.overrideMimeType("text/plain");t.open("GET",e,true);t.onreadystatechange=function(){if(t.readyState===4){if(t.status===200||t.status==0){console.log("loaded "+e);n(t.responseText)}}};t.send()}function n(n,t){e(n,function(e){t(e)})}function t(){try{var e=JSON.parse(rawFile.responseText);return e}catch(e){console.log("ERROR parseJSON - "+e);console.log("ERROR parseJSON - could not parse string, returning empty object");var n={};return n}}function o(n,o){e(n,function(e){var n=t(e);o(n)})}function r(e){var n={};var t=e.split(/\r\n|\n/);var o=t[0].split(",");o.forEach(function(e,t){o[t]=o[t].trim();n[o[t]]=[]});for(var r=1;r<t.length;r++){var i=t[r].split(",");i.forEach(function(e,t){e=e.trim();n[o[t]].push(e)})}console.log("parseCSV return");return n}function i(n,t){e(n,function(e){var n=r(e);t(n)})}function a(e,n){for(var t=0;t<e.length;t++){if(e[t]==n){e.splice(t,1);t--}}return e}function l(e){var n={};var t=e.split(/\r\n|\n/);var o=t.splice(0,32);o.splice(3,1);n["diagram title #1"]=o.splice(4,1);n["diagram title #2"]=o.splice(5,1);n["comment #1"]=o.splice(7,1);n["comment #2"]=o.splice(8,1);o.splice(25,1);a(o,"");for(var r=0;r<o.length;r++){var i=metalines[r].split(/:|=/);n[metalines[r][0]]=metalines[r][1]}var l=t[0].split(/\t/);var c=t[1].split(/\t/);for(var r=0;r<l.length;r++){l[r]=l[r].trim()+c[r].trim();n.data[l[r]]=[]}for(var r=3;r<t.length;r++){var s=t[r].split(/\t/);s.forEach(function(e,t){e=Number(e);n.data[l[t]].push(e)})}console.log("parseEOF return");return n}function c(n,t){e(n,function(e){var n=l(e);t(n)})}var s={};s.ext={txt:"handleTXT",json:"handleJSON",csv:"handleCSV",eof:"handleEOF",iof:"handleEOF",akf:"handleEOF"};s.handleTXT=n;s.handleJSON=o;s.handleCSV=i;s.handleEOF=c;function f(e){return e.substr((~-fname.lastIndexOf(".")>>>0)+2)}function u(e){return e.split("/").pop()}function d(e,n,t){if(cfunc===undefined){var t=function(){return}}if(n===undefined){var n={}}var o=0;var r=e.length;console.log("fileLoader - "+e.length+" files in queue");for(var i=0;i<e.lenth;i++){curFileExt=f(e[i]).toLowerCase();if(s.ext[curFileExt]!==undefined){(function(){var t=u(e[i]);s[s.ext[curFileExt]](e[i],function(e){n[t]=e;a()})})()}else{console.log("localFileLoader - '"+e[i]+"' is not supported");a()}}function a(){console.log(o+" files loaded");if(o==r){console.log("localFileLoader - callback: "+t.name);t(n)}else{o++}}}return d});